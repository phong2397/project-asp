
@using IceCream.Models;
@model List<IceCream.Models.Cart>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/MainLayout/_MainLayout2.cshtml";


}
<h2 style="color:red">@Html.ValidationSummary(true)</h2>
<div class="super_container">

    @{if (Session["cart"] != null)
        { <div class="cart_info">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <!-- Column Titles -->
                            <div class="cart_info_columns clearfix">
                                <div class="cart_info_col cart_info_col_product">Shopping Cart</div>
                                <div class="cart_info_col cart_info_col_price">Price</div>
                                <div class="cart_info_col cart_info_col_quantity">Quantity</div>
                                <div class="cart_info_col cart_info_col_total">Total</div>
                            </div>
                        </div>
                    </div>
                    <div class="row cart_items_row">
                        <div class="col">

                            <!-- Cart Item -->
                            @foreach (var item in (List<Cart>)Session["cart"])
                            {
                                <div class="cart_item d-flex flex-lg-row flex-column align-items-lg-center align-items-start justify-content-start">
                                    <!-- Name -->
                                    <div class="cart_item_product d-flex flex-row align-items-center justify-content-start">
                                        <div class="cart_item_image">
                                            <div><img src="@item.Product.Image" alt=""></div>
                                        </div>
                                        <div class="cart_item_name_container">
                                            <div class="cart_item_name"><a href="#">@item.Product.Name</a></div>
                                            <div class="cart_item_edit"><a href="">Add</a></div>
                                            @Html.ActionLink("Remove", "Delete", "ShoppingCart", new { id = item.Product.ProductId }, new { @onclick = "return confirm('Are you sure want to remove it?')" })
                                        </div>

                                        <div class="remove-btn">
                                            <div class="cart_item_name">
                                                @*@Html.ActionLink("Update", "UpdateQuantity", "ShoppingCart", new { id = item.Product.ProductId })*@

                                            </div>


                                        </div>
                                    </div>

                                    <!-- Price -->
                                    <div class="cart_item_price">$@item.Product.Price</div>
                                    <!-- Quantity -->


                                    <div class="cart_item_quantity">
                                        <div class="product_quantity_container">
                                            <div class="product_quantity clearfix">
                                                <span>Qty</span>
                                                <form action="@Url.Action("UpdateQuantity")" method="get">
                                                    <input type="hidden" name="id" value="@item.Product.ProductId" />
                                                    <input type="text" min="1" name="newQuantity" value="@item.Quantity" readonly="" />
                                                </form>

                                            </div>
                                        </div>
                                    </div>

                                    <!-- Total -->
                                    <div class="cart_item_total">$@(item.Product.Price * item.Quantity)</div>
                                </div>
                            }

                        </div>
                    </div>
                    <div class="br">

                    </div>
                    <div class="row row_cart_buttons">
                        <div class="col">
                            <div class="cart_buttons d-flex flex-lg-row flex-column align-items-start justify-content-start">
                                <div class="button continue_shopping_button">
                                    @Html.ActionLink("Continue Shopping", "Book", "Product")
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="row row_extra">
                        <div class="col-lg-4">

                            <!-- Delivery -->
                            <!-- Coupon Code -->

                        </div>

                    </div>
                </div>
            </div>
        }


    }
    @using (Html.BeginForm("Payment", "ShoppingCart", new { id = "customer-form" }, FormMethod.Post))
    {

        if (Session["email"] != null)
        {
            if (Session["cart"] != null)
            {
                <form action="@Url.Action("Payment")" method="get">
                    <div class="row row_extra">
                        <div class="col-lg-4">

                            <!-- Delivery -->
                            <div class="delivery">
                                <div class="section_title">Checkout Information</div>
                                <div class="section_subtitle">Select the one you want</div>
                                @{Html.RenderAction("Checkout", "Shoppingcart");}
                                @{Html.RenderAction("Shipping", "Shoppingcart");}
                            </div>
                            !                            <!-- Coupon Code -->
                            @{
                                List<Cart> temp = (List<Cart>)Session["cart"];
                                var total = temp.Sum(x => x.Quantity * x.Product.Price);
                                // var total = String.Format("{0:N0}", temp.Sum(x => x.Quantity * x.Product.Price));
                            }

                        </div>

                        <div class="col-lg-6 offset-lg-2">
                            <div class="cart_total">
                                <div class="section_title">Cart total</div>
                                <div class="section_subtitle">Final info</div>
                                <div class="cart_total_container">
                                    <ul>


                                        <input type="text" name="cusID" class="cart_total_value ml-auto" hidden="" value="@Session["id"]" />

                                        <li class="d-flex flex-row align-items-center justify-content-start">
                                            <div class="cart_total_title">Shipping</div>
                                            <div class="cart_total_value ml-auto">Free</div>
                                        </li>
                                        <li class="d-flex flex-row align-items-center justify-content-start">
                                            <div class="cart_total_title">Total</div>
                                            <input type="text" name="cusTotal" class="cart_total_value ml-auto" readonly value="@total" />
                                        </li>
                                    </ul>
                                </div>
                                <div><input type="submit" style="font-size:16px;" value="Order" class="button checkout_button" onclick="return confirm('Are you sure want to checkout?')" /></div>
                            </div>
                        </div>
                    </div>
                </form>
            }
            else
            {
                <div class="row row_extra">
                    <div class="col-lg-4">

                        <!-- Delivery -->
                        <div class="delivery">
                            <div class="section_title">Shipping method</div>
                            <div class="section_subtitle">Select the one you want</div>
                            @{Html.RenderAction("Checkout", "Shoppingcart");}
                        </div>

                        <!-- Coupon Code -->

                    </div>

                    <div class="col-lg-6 offset-lg-2">
                        <div class="cart_total">
                            <div class="section_title">Cart total</div>
                            <div class="section_subtitle">Final info</div>
                            <div class="cart_total_container">
                                <ul>

                                    <li class="d-flex flex-row align-items-center justify-content-start">
                                        <div class="cart_total_title">Shipping</div>
                                        <div class="cart_total_value ml-auto">Free</div>
                                    </li>
                                    <li class="d-flex flex-row align-items-center justify-content-start">
                                        <div class="cart_total_title">Total</div>
                                        <div class="cart_total_value ml-auto">$</div>
                                    </li>
                                </ul>
                            </div>
                            <div><a><input type="submit" value="Order" class="button checkout_button" onclick="return confirm('Please login')" /></a></div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            if (Session["cart"] != null)
            {
                <form action="@Url.Action("Payment")" method="get">
                    <div class="row row_extra">
                        <div class="col-lg-4">

                            <!-- Delivery -->
                            <div class="delivery">
                                <div class="section_title">Checkout Information</div>
                                <div class="section_subtitle">Select the one you want</div>
                                @{Html.RenderAction("Checkout", "Shoppingcart");}

                            </div>

                            <!-- Coupon Code -->
                            @{
                                List<Cart> temp = (List<Cart>)Session["cart"];
                                var total = temp.Sum(x => x.Quantity * x.Product.Price);
                                // var total = String.Format("{0:N0}", temp.Sum(x => x.Quantity * x.Product.Price));
                            }

                        </div>

                        <div class="col-lg-6 offset-lg-2">
                            <div class="cart_total">
                                <div class="section_title">Cart total</div>
                                <div class="section_subtitle">Final info</div>
                                <div class="cart_total_container">
                                    <ul>

                                        <input type="number" name="cusID" class="cart_total_value ml-auto" hidden="" value="null" />

                                        <li class="d-flex flex-row align-items-center justify-content-start">
                                            <div class="cart_total_title">Shipping</div>
                                            <div class="cart_total_value ml-auto">Free</div>
                                        </li>
                                        <li class="d-flex flex-row align-items-center justify-content-start">
                                            <div class="cart_total_title">Total</div>
                                            <input type="text" name="cusTotal" class="cart_total_value ml-auto" readonly value="@total" />
                                        </li>
                                    </ul>
                                </div>
                                <div><input type="submit" style="font-size:16px;" value="Order" class="button checkout_button" onclick="return confirm('Are you sure want to checkout?')" /></div>
                            </div>
                        </div>
                    </div>
                </form>
            }
            else
            {
                <div class="row row_extra">
                    <div class="col-lg-4">

                        <!-- Delivery -->
                        <div class="delivery">
                            <div class="section_title">Shipping method</div>
                            <div class="section_subtitle">Select the one you want</div>
                            @{Html.RenderAction("Checkout", "Shoppingcart");}
                        </div>

                        <!-- Coupon Code -->

                    </div>

                    <div class="col-lg-6 offset-lg-2">
                        <div class="cart_total">
                            <div class="section_title">Cart total</div>
                            <div class="section_subtitle">Final info</div>
                            <div class="cart_total_container">
                                <ul>

                                    <li class="d-flex flex-row align-items-center justify-content-start">
                                        <div class="cart_total_title">Shipping</div>
                                        <div class="cart_total_value ml-auto">Free</div>
                                    </li>
                                    <li class="d-flex flex-row align-items-center justify-content-start">
                                        <div class="cart_total_title">Total</div>
                                        <div class="cart_total_value ml-auto">$</div>
                                    </li>
                                </ul>
                            </div>
                            <div><a><input type="submit" value="Order" class="button checkout_button" onclick="return confirm('Please login')" /></a></div>
                        </div>
                    </div>
                </div>
            }
        }


    }

</div>
